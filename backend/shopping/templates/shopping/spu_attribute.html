{% extends 'shopping/base.html' %}

{% block title %}设置商品属性 - 商品管理系统{% endblock %}

{% block content %}
<nav class="breadcrumb" aria-label="breadcrumbs">
    <ul>
        <li><a href="{% url 'shopping:product_management' %}">商品列表</a></li>
        <li class="is-active"><a href="#" aria-current="page">设置商品属性</a></li>
    </ul>
</nav>

<h1 class="title">设置商品属性</h1>
<p class="subtitle">商品：{{ spu.name }}</p>

<div class="box">
    <div class="notification is-info is-light">
        <p><strong>说明：</strong></p>
        <ul>
            <li>选择此商品需要的属性（如颜色、尺码等）</li>
            <li>设置属性后，创建SKU时需要为每个属性选择具体的值</li>
            <li>如果还没有需要的属性，请先到 <a href="{% url 'shopping:attribute_management' %}">属性管理</a> 页面创建</li>
        </ul>
    </div>

    <form method="post">
        {% csrf_token %}
        
        <div class="field">
            <label class="label">选择属性</label>
            
            {% for attribute in all_attributes %}
            <div class="field">
                <div class="control">
                    <label class="checkbox">
                        <input type="checkbox" name="attributes" value="{{ attribute.id }}" 
                            {% if attribute.id in current_attributes %}checked{% endif %}>
                        <strong>{{ attribute.name }}</strong>
                    </label>
                    <div class="tags ml-5 mt-2">
                        {% for value in attribute.values.all %}
                        <span class="tag is-light">{{ value.value }}</span>
                        {% empty %}
                        <span class="tag is-warning is-light">该属性还没有属性值</span>
                        {% endfor %}
                    </div>
                </div>
            </div>
            {% empty %}
            <div class="notification is-warning">
                <p>还没有创建任何属性。</p>
                <p>请先到 <a href="{% url 'shopping:attribute_management' %}">属性管理</a> 页面创建属性。</p>
            </div>
            {% endfor %}
        </div>

        {% if all_attributes %}
        <div class="field is-grouped">
            <div class="control">
                <button type="submit" class="button is-primary">
                    <span class="icon"><i class="fas fa-save"></i></span>
                    <span>保存</span>
                </button>
            </div>
            <div class="control">
                <a href="{% url 'shopping:product_management' %}" class="button is-light">
                    <span class="icon"><i class="fas fa-times"></i></span>
                    <span>取消</span>
                </a>
            </div>
        </div>
        {% endif %}
    </form>
</div>
{% endblock %}
